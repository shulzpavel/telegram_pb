# üÉè Telegram Planning Poker Bot

–ë–æ—Ç –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á –ø–æ –º–µ—Ç–æ–¥—É **Planning Poker**. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–∞—Ö Telegram —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–æ–∫, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π –ø–æ —Ç–æ–∫–µ–Ω—É, –ø–æ–¥—Å—á—ë—Ç–æ–º —Å—Ä–µ–¥–Ω–µ–π –æ—Ü–µ–Ω–∫–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—ã–≤–æ–¥–æ–º –∏—Ç–æ–≥–æ–≤ —Å–µ—Å—Å–∏–∏.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **–≥—Ä—É–ø–ø–æ–≤—ã—Ö Telegram-—á–∞—Ç–æ–≤ —Å —Ç–æ–ø–∏–∫–∞–º–∏**
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–æ `/join <—Ç–æ–∫–µ–Ω>`
- –û—Ü–µ–Ω–∫–∞ –∑–∞–¥–∞—á –ø–æ —à–∫–∞–ª–µ **Fibonacci (1, 2, 3, 5, 8, 13)**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **–ø–∞–∫–µ—Ç–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–¥–∞—á** (batch mode)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤ –ø–æ –±–∞–Ω—á—É —Å **—Å—É–º–º–æ–π SP –∑–∞ –±–∞—Ç—á**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ `chat_id` –∏ `topic_id`
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å **Jira API** –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á
- –ú–µ—Ç—Ä–∏–∫–∏ –≤ Postgres + –≥–æ—Ç–æ–≤—ã–µ Grafana –¥–∞—à–±–æ—Ä–¥—ã (—Å–º. `docs/GRAFANA.md`)
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ + audit —Å–æ–±—ã—Ç–∏—è
- **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ Jira Service, Voting Service –∏ Telegram Gateway
- **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º —Å–ª–æ–µ–≤ (domain, usecases, ports, adapters)
- **Dependency Injection** –¥–ª—è –ª–µ–≥–∫–æ–π –∑–∞–º–µ–Ω—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ —Ç—Ä–µ–±—É–µ—Ç –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/shulzpavel/telegram_pb.git
cd telegram_pb
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã —á–µ—Ä–µ–∑ Docker Compose

```bash
docker-compose up -d
```

–≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç:
- **Jira Service** (–ø–æ—Ä—Ç 8001)
- **Voting Service** (–ø–æ—Ä—Ç 8002)
- **Redis** (–¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏–π)
- **Postgres** (–¥–ª—è –º–µ—Ç—Ä–∏–∫)
- **Telegram Gateway** (–±–æ—Ç)

### 3. –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# –ó–∞–ø—É—Å—Ç–∏—Ç—å Jira Service
python -m services.jira_service.main &

# –ó–∞–ø—É—Å—Ç–∏—Ç—å Voting Service
python -m services.voting_service.main &

# –ó–∞–ø—É—Å—Ç–∏—Ç—å Gateway
python run.py
```

---

## üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `.env`

–°–æ–∑–¥–∞–π—Ç–µ `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example`:

```bash
cp env.example .env
```

**–í–∞–∂–Ω–æ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–∫–∞–∑–∞–Ω—ã URLs –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤:
```bash
JIRA_SERVICE_URL=http://localhost:8001
VOTING_SERVICE_URL=http://localhost:8002
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` –∏ —É–∫–∞–∂–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:

```dotenv
# Telegram Bot Configuration
BOT_TOKEN=YOUR_TELEGRAM_BOT_TOKEN

# User Role Tokens
USER_TOKEN=user_token
LEAD_TOKEN=lead_token
ADMIN_TOKEN=admin_token

# Jira Configuration
JIRA_URL=https://your-domain.atlassian.net
JIRA_USERNAME=your-email@domain.com
JIRA_API_TOKEN=YOUR_JIRA_API_TOKEN
STORY_POINTS_FIELD=customfield_10022

# Supported Topics (JSON format)
# Example: {"-1003087077812": ["ALL"]} - allows all topics in chat -1003087077812
# Example: {"-1003087077812": [1, 2, 3]} - allows specific topics
SUPPORTED_TOPICS={"-1003087077812": ["ALL"]}

# State File Path
STATE_FILE=data/state.json
```

**–í–∞–∂–Ω–æ:** –§–∞–π–ª `.env` —É–∂–µ –≤ `.gitignore` –∏ –Ω–µ –±—É–¥–µ—Ç –∑–∞–∫–æ–º–º–∏—á–µ–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
source venv/bin/activate
python3 run.py
```

–ò–ª–∏ —á–µ—Ä–µ–∑ Makefile:

```bash
make run
```

### –ó–∞–ø—É—Å–∫ –±–µ–∑ polling (–¥–ª—è –≤—Ç–æ—Ä–∏—á–Ω—ã—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤)

```bash
python3 run.py --no-poll
```

---

## üñ•Ô∏è –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ systemd

### 1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ service —Ñ–∞–π–ª

```bash
sudo cp telegram-pb-bot.service /etc/systemd/system/
```

### 2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ service —Ñ–∞–π–ª

–ò–∑–º–µ–Ω–∏—Ç–µ –ø—É—Ç–∏ –≤ `/etc/systemd/system/telegram-pb-bot.service`:

```ini
[Service]
# –í–ê–ñ–ù–û: –ó–∞–º–µ–Ω–∏—Ç–µ your_username –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
User=your_username
# –í–ê–ñ–ù–û: –ó–∞–º–µ–Ω–∏—Ç–µ /path/to/telegram_pb –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –ø—É—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä: /home/user/telegram_pb)
WorkingDirectory=/path/to/telegram_pb
# –í–ê–ñ–ù–û: –ó–∞–º–µ–Ω–∏—Ç–µ /path/to/telegram_pb –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –ø—É—Ç—å
EnvironmentFile=/path/to/telegram_pb/.env
# –í–ê–ñ–ù–û: –ó–∞–º–µ–Ω–∏—Ç–µ /path/to/telegram_pb –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –ø—É—Ç—å
ExecStart=/usr/bin/python3 /path/to/telegram_pb/run.py
```

### 3. –°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª –≤ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏ (—Å–º. `env.example`).

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ service

```bash
sudo systemctl daemon-reload
sudo systemctl enable telegram-pb-bot
sudo systemctl start telegram-pb-bot
```

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å

```bash
sudo systemctl status telegram-pb-bot
journalctl -u telegram-pb-bot -f
```

---

## üìå –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

1. –£—á–∞—Å—Ç–Ω–∏–∫ –ø–∏—à–µ—Ç:  
   ```
   /join <—Ç–æ–∫–µ–Ω>
   ```
   –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã: `USER_TOKEN`, `LEAD_TOKEN`, `ADMIN_TOKEN` (–∏–∑ `.env`)

2. –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏:
   - üÜï –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
   - ‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞–¥–∞—á–∏ –∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –Ω–µ –∞–∫—Ç–∏–≤–Ω–æ)
   - üìã –ò—Ç–æ–≥–∏ –¥–Ω—è
   - üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏
   - üö™ –ü–æ–∫–∏–Ω—É—Ç—å
   - üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞
   - üóëÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –æ—á–µ—Ä–µ–¥—å (—Ç–æ–ª—å–∫–æ –¥–ª—è –ª–∏–¥–æ–≤/–∞–¥–º–∏–Ω–æ–≤, –µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥–∏)

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á –∏–∑ Jira

–õ–∏–¥–µ—Ä—ã –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å **JQL –∑–∞–ø—Ä–æ—Å—ã** –≤ —á–∞—Ç:

```
project = FLEX AND status = "To Do"
```

–∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –∑–∞–¥–∞—á:

```
FLEX-123, FLEX-456
```

–ë–æ—Ç:
- –ü–æ–∫–∞–∂–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "‚è≥ –û–∂–∏–¥–∞–π—Ç–µ, –∏–¥–µ—Ç –ø–æ–∏—Å–∫ –∑–∞–¥–∞—á –≤ Jira..." (–¥–ª—è –±–æ–ª—å—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
- –ù–∞–π–¥–µ—Ç –∑–∞–¥–∞—á–∏ –≤ Jira –ø–æ –∑–∞–ø—Ä–æ—Å—É
- –î–æ–±–∞–≤–∏—Ç –∏—Ö –≤ –æ—á–µ—Ä–µ–¥—å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
- –ü–æ–∫–∞–∂–µ—Ç –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" –∏ "–ù–∞—á–∞—Ç—å" –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è

### –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ

- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥–æ–ª–æ—Å—É—é—Ç —á–µ—Ä–µ–∑ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏ (1, 2, 3, 5, 8, 13)
- **–ö–Ω–æ–ø–∫–∞ "‚è≠Ô∏è –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"** ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –ø–æ –∑–∞–¥–∞—á–µ
  - –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π –≥–æ–ª–æ—Å –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–¥—Å—á–µ—Ç–µ Story Points
  - –ü—Ä–æ–ø—É—Å–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ —É—á–∞—Å—Ç–∏–µ –≤ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–∏ (–¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–µ)
- –ü–æ—Å–ª–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∞) –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–µ
- –ü–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–¥–∞—á–∏ ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏—Å—ã–ª–∞–µ—Ç –∏—Ç–æ–≥–∏ —Å **—Å—É–º–º–æ–π SP –∑–∞ –±–∞—Ç—á**
- **Story Points** ‚Äî –≤ Jira –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ** –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –≤—Å–µ—Ö –≥–æ–ª–æ—Å–æ–≤
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ —Å –¥–µ—Ç–∞–ª—è–º–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –∏ –∏—Ç–æ–≥–æ–≤–æ–π —Å—É–º–º–æ–π SP

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Story Points –≤ Jira

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –ø–æ –∑–∞–¥–∞—á–µ, –ª–∏–¥–µ—Ä—ã –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –æ–±–Ω–æ–≤–∏—Ç—å Story Points –≤ Jira —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "–û–±–Ω–æ–≤–∏—Ç—å –≤ Jira".

### –°–±—Ä–æ—Å –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á

–õ–∏–¥–µ—Ä—ã –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —Å–±—Ä–æ—Å–∏—Ç—å –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á, –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏–ª–∏ –Ω–µ —Ç–µ –∑–∞–¥–∞—á–∏ –∏–ª–∏ –Ω—É–∂–Ω–æ –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ:

1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"üóëÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –æ—á–µ—Ä–µ–¥—å"** –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é (–ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞–¥–∞—á–∏)
2. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å–±—Ä–æ—Å –≤ –¥–∏–∞–ª–æ–≥–µ
3. –û—á–µ—Ä–µ–¥—å –±—É–¥–µ—Ç –æ—á–∏—â–µ–Ω–∞, —Ç–µ–∫—É—â–µ–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
4. **–ò—Å—Ç–æ—Ä–∏—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è** ‚Äî –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ "üìã –ò—Ç–æ–≥–∏ –¥–Ω—è"

**–í–∞–∂–Ω–æ:**
- –ü—Ä–∏ —Å–±—Ä–æ—Å–µ –≤–æ –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø–æ–ª—É—á–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—Å—Ç–∞–Ω–æ–≤–∫–µ
- –ò—Å—Ç–æ—Ä–∏—è (`history`) –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞—Ç—á (`last_batch`) –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è
- –ü–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞ –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ —á–µ—Ä–µ–∑ JQL

---

## üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥–æ–ª–æ—Å—É—é—Ç —á–µ—Ä–µ–∑ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏ (1, 2, 3, 5, 8, 13)
- **–ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"** ‚Äî —É—á–∞—Å—Ç–Ω–∏–∫ –º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –ø–æ –∑–∞–¥–∞—á–µ
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ SP** ‚Äî –≤ Jira –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∏–∑ –≤—Å–µ—Ö –≥–æ–ª–æ—Å–æ–≤
- –ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ ‚Äî —Å—É–º–º–∞ –≤—Å–µ—Ö **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö** –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ –∑–∞–¥–∞—á–∞–º
- **–°–±—Ä–æ—Å –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á** ‚Äî –ª–∏–¥–µ—Ä—ã/–∞–¥–º–∏–Ω—ã –º–æ–≥—É—Ç —Å–±—Ä–æ—Å–∏—Ç—å –æ—á–µ—Ä–µ–¥—å —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º (–∏—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Ç–æ–≤ –∏ —Ç–æ–ø–∏–∫–æ–≤ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `SUPPORTED_TOPICS`)
- –ì–æ–ª–æ—Å–∞ –Ω–µ —Å—á–∏—Ç–∞—é—Ç—Å—è, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏** –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –∑–∞–¥–∞—á –≤ Jira (–¥–ª—è –±–æ–ª—å—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å Jira API** (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç event loop)
- **–ê—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–ø–∏—Å—å —Å–æ—Å—Ç–æ—è–Ω–∏—è** (–∑–∞—â–∏—Ç–∞ –æ—Ç –∫–æ—Ä—Ä—É–ø—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```bash
make test
```

–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:

```bash
pytest
```

**–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏:** 54 —Ç–µ—Å—Ç–∞ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤–µ—Å—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- ‚úÖ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (Session, Task, Participant)
- ‚úÖ Use cases (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á, –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –±–∞—Ç—á–∞)
- ‚úÖ Voting policy (–ø–æ–¥—Å—á–µ—Ç SP, —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–ø–æ–ª–Ω—ã–π workflow)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ busy-—Ñ–ª–∞–≥–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ Jira API (skip errors —Ä–µ–∂–∏–º)

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
telegram_pb/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ adapters/              # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Ä—Ç–æ–≤ (Jira HTTP, File storage, Telegram notifier)
‚îÇ   ‚îú‚îÄ‚îÄ domain/                # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞
‚îÇ   ‚îú‚îÄ‚îÄ keyboards/             # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ models/                # –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (—Ä–µ—ç–∫—Å–ø–æ—Ä—Ç –∏–∑ domain)
‚îÇ   ‚îú‚îÄ‚îÄ ports/                 # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (JiraClient, SessionRepository, Notifier)
‚îÇ   ‚îú‚îÄ‚îÄ providers.py           # DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —Å–±–æ—Ä–∫–∞ –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ –∏ use case'–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ transport/telegram/    # Aiogram-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç: router, middleware, handlers
‚îÇ   ‚îú‚îÄ‚îÄ usecases/              # –ë–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–∏ (add_tasks, start_batch, cast_vote, ...)
‚îÇ   ‚îî‚îÄ‚îÄ utils/                 # –£—Ç–∏–ª–∏—Ç—ã (context, audit, telegram helpers)
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ TECHNICAL.md           # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
‚îÇ   ‚îî‚îÄ‚îÄ MICROSERVICES.md       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ jira-service/          # Jira Service (FastAPI)
‚îÇ   ‚îú‚îÄ‚îÄ voting-service/        # Voting Service (FastAPI)
‚îÇ   ‚îî‚îÄ‚îÄ gateway/               # Telegram Gateway (aiogram)
‚îú‚îÄ‚îÄ k8s/                       # Kubernetes –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã
‚îî‚îÄ‚îÄ docker-compose.yml         # Docker Compose –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ data/              # –î–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ tests/             # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ run.py             # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ session_store.py   # –•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–µ—Å—Å–∏–π (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–¥–∞–ø—Ç–µ—Ä–æ–º)
‚îú‚îÄ‚îÄ config.py          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt   # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ env.example        # –ü—Ä–∏–º–µ—Ä .env —Ñ–∞–π–ª–∞
‚îî‚îÄ‚îÄ telegram-pb-bot.service  # systemd service —Ñ–∞–π–ª
```

---

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
make install
```

### –ó–∞–ø—É—Å–∫

```bash
make run
```

### –¢–µ—Å—Ç—ã

```bash
make test
```

---

## üèóÔ∏è –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:

### –°–µ—Ä–≤–∏—Å—ã

- **Jira Service** (–ø–æ—Ä—Ç 8001) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º —Å Jira API, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- **Voting Service** (–ø–æ—Ä—Ç 8002) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ –∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ–º, —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Redis/Postgres
- **Telegram Gateway** - —Ç–æ–Ω–∫–∏–π –∫–ª–∏–µ–Ω—Ç –∫ —Å–µ—Ä–≤–∏—Å–∞–º, –æ–±—Ä–∞–±–æ—Ç–∫–∞ Telegram —Å–æ–±—ã—Ç–∏–π (aiogram)

### –ó–∞–ø—É—Å–∫

```bash
# Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
docker-compose up -d

# Kubernetes
kubectl apply -f k8s/
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```bash
# Health checks
curl http://localhost:8001/health/
curl http://localhost:8002/health/
```

–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [`docs/MICROSERVICES.md`](docs/MICROSERVICES.md)

---

## ‚ú® –ò–¥–µ–∏ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Jira API (–ø–æ–∏—Å–∫ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤)
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `/history` –ø–æ –≤—Å–µ–º —Å–µ—Å—Å–∏—è–º
- [ ] –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–ø—Ä–∏–Ω—Ç–∞–º
- [ ] –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
